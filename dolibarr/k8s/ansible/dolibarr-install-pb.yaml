---
- name: "Install Dolibarr"
  hosts: "{{ k8s_host | default('localhost') }}"
  gather_facts: "{{ gathering_host_info | default('true') | bool == true }}"

  pre_tasks:
    - name: "Validate variables"
      assert:
        that:
          # - "pv_root_folder is defined"
          - "app_name is defined"
          - "app_namespace is defined"
        fail_msg: "Missing required parameters"

  tasks:
    - name: "Create deployment"
      kubernetes.core.k8s:
        definition:
          apiVersion: apps/v1
          kind: Deployment
          metadata:
            name: example
            namespace: testing
            "app.kubernetes.io/name": "{{ app_name }}"
            "app.kubernetes.io/version": "{{ app_version }}"
          spec:
            paused: True
        wait: yes
        wait_condition:
          type: Progressing
          status: Unknown
          reason: DeploymentPaused

...
