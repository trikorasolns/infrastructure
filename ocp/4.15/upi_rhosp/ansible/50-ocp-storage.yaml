---
- name: "Collect information"
  import_playbook: _common_rhosp.yaml
  when: ocp_cluster_id_tag is not defined

- name: "Cinder as storage Backend"
  hosts: "localhost"
  gather_facts: true

  tasks:
  - name: "Template cloud.conf"
    ansible.builtin.set_fact:
      rhosp_cloud_conf: "{{ lookup('template', 'cloud.conf.j2') }}"
  
  - name: "Template cloud.conf Secret"
    ansible.builtin.template:
      src: csi-secret-cinderplugin.yaml.j2
      dest: "/tmp/csi-secret-cinderplugin.yaml"
      mode: 0600

  
  - name: "Create cloud.conf secret"
    ansible.builtin.command: |
      oc apply -f /tmp/csi-secret-cinderplugin.yaml
    register: ocp_cinder_secret

...
