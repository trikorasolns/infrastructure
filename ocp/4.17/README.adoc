= OCP UPI Installation on Proxmox
Antonio C. <ac (at) trikorasolutions (dot) com>
:revdate: {docdate}
:icons: font
:toc: left
:toclevels: 3
:toc-title: Table of Contents
:description: OCP UPI Installation on Proxmox

[WARNING]
====
ATTOW this process isn't working with the following error.

[source,bash]
----
journalctl -b -f -u release-image.service -u bootkube.service
----

[source,]
----
 ocp4-bootstrap bootkube.sh[956042]: /usr/local/bin/bootkube.sh: line 85: oc: command not found
----

It seems to be due to an issue discussed on GitHub accesible on the following link.

link:https://github.com/okd-project/okd/discussions/2104[OC command not in /usr/local/bin/bootkube.sh error #2104].
====

== Introduction

[.lead]
This document describes the OCP installation process using UPI. It automates 
 the instructions found at https://blog.rossbrigoli.com/2020/11/running-openshift-at-home-part-44.html.

=== Services host

[source,bash]
----
OCP_CLI_INSTALL_DIR=/tmp<1>
RH_CLUSTER_PULL_SECRET=<2>
SSH_PUB_KEY_FILE=<3>
----
<1>
<2> Get a Red Hat pull secret by logging in to https://cloud.redhat.com. 
 Navigate to _Cluster Manager > Create Cluster > Red Hat Openshift Container Platform > Run on Baremetal > User-Provisioned Infrastructure_
 and press _Copy pull secret_.
<3>

[source,bash]
----
ansible-playbook ocp/install_upi/ansible/ocp-services-02-gen-playbook.yaml -e @ocp/install_upi/ansible/defaults/main.yaml -e ocp_cli_install_dir=${OCP_CLI_INSTALL_DIR} -e pull_secret=${RH_CLUSTER_PULL_SECRET} -e ssh_pub_key_file=${SSH_PUB_KEY_FILE}
----

[source,bash]
----
ansible-playbook ocp/install_upi/ansible/ocp-services-03-config-playbook.yaml -e @ocp/install_upi/ansible/defaults/main.yaml -K
----

