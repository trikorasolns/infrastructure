---
- name: "Create LVM DaemonSet"
  hosts: "{{ k8s_host | default('localhost') }}"
  gather_facts: "{{ gathering_host_info | default('true') | bool == true }}"

  pre_tasks:

  tasks:

  - name: "Create application k8s namespace"
    kubernetes.core.k8s:
      src: files/ceph-rbd-provisioner.yml
      state: present

  - name: "Create k8s secret with Ceph Admin key"
    ansible.builtin.shell: |
      kubectl create secret generic ceph-admin-secret  \
        --type="kubernetes.io/rbd" \
        --from-literal=key='{{ ceph_admin_key }}' \
        --namespace=kube-system
...

