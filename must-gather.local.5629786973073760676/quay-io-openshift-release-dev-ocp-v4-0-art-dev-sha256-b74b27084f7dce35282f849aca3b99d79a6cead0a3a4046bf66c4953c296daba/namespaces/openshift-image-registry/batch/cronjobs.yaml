---
apiVersion: batch/v1
items:
- apiVersion: batch/v1
  kind: CronJob
  metadata:
    annotations:
      imageregistry.operator.openshift.io/checksum: sha256:cdb184c46143684b6f9aebaffd2dfcb34cd52194d89d3cb81406412183dc2062
    creationTimestamp: "2025-03-31T20:23:18Z"
    generation: 1
    managedFields:
    - apiVersion: batch/v1
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:annotations:
            .: {}
            f:imageregistry.operator.openshift.io/checksum: {}
        f:spec:
          f:concurrencyPolicy: {}
          f:failedJobsHistoryLimit: {}
          f:jobTemplate:
            f:metadata:
              f:annotations:
                .: {}
                f:openshift.io/required-scc: {}
              f:labels:
                .: {}
                f:created-by: {}
            f:spec:
              f:backoffLimit: {}
              f:template:
                f:spec:
                  f:affinity: {}
                  f:containers:
                    k:{"name":"image-pruner"}:
                      .: {}
                      f:args: {}
                      f:command: {}
                      f:image: {}
                      f:imagePullPolicy: {}
                      f:name: {}
                      f:resources:
                        .: {}
                        f:requests:
                          .: {}
                          f:cpu: {}
                          f:memory: {}
                      f:terminationMessagePath: {}
                      f:terminationMessagePolicy: {}
                      f:volumeMounts:
                        .: {}
                        k:{"mountPath":"/var/run/configmaps/serviceca"}:
                          .: {}
                          f:mountPath: {}
                          f:name: {}
                          f:readOnly: {}
                  f:dnsPolicy: {}
                  f:priorityClassName: {}
                  f:restartPolicy: {}
                  f:schedulerName: {}
                  f:securityContext: {}
                  f:serviceAccount: {}
                  f:serviceAccountName: {}
                  f:terminationGracePeriodSeconds: {}
                  f:volumes:
                    .: {}
                    k:{"name":"serviceca"}:
                      .: {}
                      f:configMap:
                        .: {}
                        f:defaultMode: {}
                        f:name: {}
                      f:name: {}
          f:schedule: {}
          f:startingDeadlineSeconds: {}
          f:successfulJobsHistoryLimit: {}
          f:suspend: {}
      manager: cluster-image-registry-operator
      operation: Update
      time: "2025-03-31T20:23:18Z"
    - apiVersion: batch/v1
      fieldsType: FieldsV1
      fieldsV1:
        f:status:
          f:lastScheduleTime: {}
          f:lastSuccessfulTime: {}
      manager: kube-controller-manager
      operation: Update
      subresource: status
      time: "2025-04-02T00:00:04Z"
    name: image-pruner
    namespace: openshift-image-registry
    resourceVersion: "559980"
    uid: 8c37a072-a85c-4957-862d-02553ec92ea4
  spec:
    concurrencyPolicy: Forbid
    failedJobsHistoryLimit: 3
    jobTemplate:
      metadata:
        annotations:
          openshift.io/required-scc: restricted-v2
        creationTimestamp: null
        labels:
          created-by: image-pruner
      spec:
        backoffLimit: 0
        template:
          metadata:
            creationTimestamp: null
          spec:
            affinity: {}
            containers:
            - args:
              - -c
              - |
                set -eu
                "$@" && exit
                for i in 1 2 3 4 5; do
                  echo "attempt #$i has failed (exit code $?), going to make another attempt..." >&2
                  sleep $(($i * 30))
                  "$@" && break  # this is the last command of the script, so its last failure will be exit code of the script
                done
              - arg0
              - oc
              - adm
              - prune
              - images
              - --confirm=true
              - --certificate-authority=/var/run/configmaps/serviceca/service-ca.crt
              - --keep-tag-revisions=3
              - --keep-younger-than=60m
              - --ignore-invalid-refs=true
              - --loglevel=1
              - --prune-registry=false
              command:
              - /bin/sh
              image: quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:44e420c9f9921cbce70f04dbedf3abfb901dc76cdaa85c5054d8be37f8d02e6e
              imagePullPolicy: IfNotPresent
              name: image-pruner
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
              - mountPath: /var/run/configmaps/serviceca
                name: serviceca
                readOnly: true
            dnsPolicy: ClusterFirst
            priorityClassName: system-cluster-critical
            restartPolicy: Never
            schedulerName: default-scheduler
            securityContext: {}
            serviceAccount: pruner
            serviceAccountName: pruner
            terminationGracePeriodSeconds: 30
            volumes:
            - configMap:
                defaultMode: 420
                name: serviceca
              name: serviceca
    schedule: 0 0 * * *
    startingDeadlineSeconds: 3600
    successfulJobsHistoryLimit: 3
    suspend: false
  status:
    lastScheduleTime: "2025-04-02T00:00:00Z"
    lastSuccessfulTime: "2025-04-02T00:00:04Z"
kind: CronJobList
metadata:
  resourceVersion: "718147"
